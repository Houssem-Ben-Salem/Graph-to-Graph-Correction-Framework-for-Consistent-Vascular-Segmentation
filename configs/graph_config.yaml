*# Graph Correction Configuration

# Graph Extraction Configuration
graph_extraction:
  # Preprocessing
  morphological_cleaning:
    min_component_size: 27  # 3x3x3 voxels
    gaussian_smoothing_sigma: 0.5
    fill_holes: true
    
  # Skeletonization
  skeleton_method: "lee"  # lee, zhang_suen, medial_axis
  spur_removal_length: 3  # voxels
  
  # Node Placement
  node_placement:
    bifurcation_buffer_radius: 2  # voxels
    adaptive_sampling: true
    base_density: 2.0  # voxels between nodes
    curvature_weight: 5.0
    min_node_distance: 0.5  # voxels
    max_node_distance: 3.0  # voxels
    
  # Attribute Extraction
  attributes:
    extract_radius: true
    extract_curvature: true
    extract_confidence: true
    neighborhood_size: 3  # for local statistics

# Graph Correspondence Configuration
correspondence:
  method: "hungarian"  # hungarian, greedy, learned
  spatial_weight: 0.4
  structural_weight: 0.4
  global_weight: 0.2
  distance_threshold: 5.0  # mm
  confidence_threshold: 0.7
  
# Graph Correction Network Configuration
graph_network:
  # Architecture
  model_type: "HierarchicalGraphCorrector"
  hidden_dim: 256
  num_gnn_layers: 6
  
  # Topology Correction Module
  topology_corrector:
    num_heads: 8
    dropout: 0.1
    edge_dim: 32
    
  # Anatomy Correction Module  
  anatomy_corrector:
    enforce_murrays_law: true
    murrays_exponent: 3.0
    radius_correction_range: [-2.0, 2.0]  # mm
    
  # Global Consistency Module
  consistency_enforcer:
    transformer_layers: 2
    transformer_heads: 8
    
# Training Configuration
training:
  batch_size: 8  # graphs per batch
  learning_rate: 0.0001
  optimizer: "AdamW"
  weight_decay: 0.00001
  scheduler:
    type: "cosine_restarts"
    T_0: 50
    T_mult: 2
  epochs: 300
  
  # Curriculum Learning
  curriculum:
    enabled: true
    stages:
      - name: "synthetic_simple"
        epochs: 50
        degradation_level: "mild"
      - name: "synthetic_complex"
        epochs: 50
        degradation_level: "moderate"
      - name: "real_data"
        epochs: 200
        
# Loss Configuration
loss:
  weights:
    topology: 1.0
    anatomy: 0.8
    consistency: 0.6
    improvement: 1.2
    regularization: 0.1
    
# Synthetic Degradation Configuration
degradation:
  levels:
    mild:
      edge_removal_prob: 0.06
      false_edge_prob: 0.02
      position_noise_std: 0.5
      radius_noise_std: 0.2
    moderate:
      edge_removal_prob: 0.15
      false_edge_prob: 0.05
      position_noise_std: 1.0
      radius_noise_std: 0.5
    severe:
      edge_removal_prob: 0.24
      false_edge_prob: 0.08
      position_noise_std: 1.5
      radius_noise_std: 0.8

# Template Reconstruction Configuration
reconstruction:
  template_library:
    cylinder_resolution: 32
    bifurcation_resolution: 64
    smoothing_factor: 0.5
  rendering:
    method: "sdf"  # sdf, voxel_painting
    interpolation: "trilinear"
    boundary_smoothing: true
    
# Validation Configuration
validation:
  metrics:
    - "dice"
    - "sensitivity" 
    - "precision"
    - "hausdorff_distance"
    - "topology_preservation"
    - "murrays_law_compliance"
  val_interval: 5
  
# Hardware Configuration
hardware:
  device: "cuda"
  mixed_precision: true
  gradient_checkpointing: true
  num_workers: 4